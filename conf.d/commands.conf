/* Centreon Plugin Commands 
 * by Benjamin Hartwich
 *
 * Please update the path to your centreon path and
 * set the constant CustomPluginDir
 */


/* SNMP Commands for linux */

object CheckCommand "centreon-snmp-load" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::linux::snmp::plugin"
        "--mode" = "load"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning" = "$snmp_warn$"
        "--critical" = "$snmp_crit$"
   }
}

object CheckCommand "centreon-snmp-memory" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::linux::snmp::plugin"
        "--mode" = "memory"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning-usage-prct" = "$snmp_warn$"
        "--critical-usage-prct" = "$snmp_crit$"
   }
}

object CheckCommand "centreon-snmp-swap" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::linux::snmp::plugin"
        "--mode" = "swap"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning-usage-prct" = "$snmp_warn$"
        "--critical-usage-prct" = "$snmp_crit$"
   }
}

object CheckCommand "centreon-snmp-interfaces" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::linux::snmp::plugin"
        "--mode" = "interfaces"
        "--hostname" = "$address$"
        "--name" = "$snmp_interface$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
//        "--warning" = "$snmp_warn$"
//        "--critical" = "$snmp_crit$"
        "--range-perfdata" = "1"
         "add_option" = {
                value = "--add-traffic"
                skip_key = true
                }
         "add_option2" = {
                value = "--nagvis-perfdata"
                skip_key = true
                }
        }
}

object CheckCommand "centreon-snmp-storage" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::linux::snmp::plugin"
        "--mode" = "storage"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning-usage" = "$snmp_warn$"
        "--critical-usage" = "$snmp_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "centreon-snmp-processcount" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::linux::snmp::plugin"
        "--mode" = "processcount"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning" = "$snmp_warn$"
        "--critical" = "$snmp_crit$"
   }
}

object CheckCommand "centreon-snmp-cpu-detailed" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "os::linux::snmp::plugin"
        "--mode" = "cpu-detailed"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning-wait" = "$snmp_warn$"
        "--critical-wait" = "$snmp_crit$"
                "--range-perfdata" = "1"
   }
}

object CheckCommand "centreon-snmp-diskio" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "os::linux::snmp::plugin"
        "--mode" = "diskio"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning-sum-read-write-iops" = "$snmp_warn$"
        "--critical-sum-read-write-iops" = "$snmp_crit$"
                "--range-perfdata" = "1"
   }
}

object CheckCommand "centreon-snmp-tcpretrans" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::protocols::snmp::plugin"
        "--mode" = "numeric-value"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--oid" = ".1.3.6.1.2.1.6.12.0"
        "--oid-type=counter" = ""
        "--warning" = "$snmp_warn$"
        "--critical" = "$snmp_crit$"
                "--range-perfdata" = "1"
   }
}

/* SNMP Commands for windows */

object CheckCommand "centreon-snmp-load-win" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::windows::snmp::plugin"
        "--mode" = "load"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning" = "$snmp_warn$"
        "--critical" = "$snmp_crit$"
        "--range-perfdata" = "1"
   }
}

object CheckCommand "centreon-snmp-cpu-win" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::windows::snmp::plugin"
        "--mode" = "cpu"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning" = "$snmp_warn$"
        "--critical" = "$snmp_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "centreon-snmp-memory-win" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::windows::snmp::plugin"
        "--mode" = "memory"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning" = "$snmp_warn$"
        "--critical" = "$snmp_crit$"
        "--range-perfdata" = "1"
   }
}

object CheckCommand "centreon-snmp-storage-win" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::windows::snmp::plugin"
        "--mode" = "storage"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning" = "$snmp_warn$"
        "--critical" = "$snmp_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "centreon-snmp-swap-win" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::windows::snmp::plugin"
        "--mode" = "swap"
        "--hostname" = "$address$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
        "--warning" = "$snmp_warn$"
        "--critical" = "$snmp_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "centreon-snmp-interfaces-list-win" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::windows::snmp::plugin"
        "--mode" = "list-interfaces"
        "--hostname" = "$address$"
        "--name" = "$snmp_interface$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
//        "--warning" = "$snmp_warn$"
//        "--critical" = "$snmp_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "centreon-snmp-interfaces-win" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl]
   arguments = {
        "--plugin" = "os::windows::snmp::plugin"
        "--mode" = "interfaces"
        "--hostname" = "$address$"
              "--interface" = "$snmp_interface$"
        "--snmp-version" = "2c"
        "--snmp-community" = "$snmp_community$"
//        "--warning" = "$snmp_warn$"
//        "--critical" = "$snmp_crit$"
        "--range-perfdata" = "1"
        }
}

/* Jolokia Java Monitoring - install Jolokia first */

object CheckCommand "jolokia-gc" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::tomcat::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "gc-usage"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        //"--warning" = "$jolokia_warn$"
        //"--critical" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "jolokia-fd" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::tomcat::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "fd-usage"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        //"--warning" = "$jolokia_warn$"
        //"--critical" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "jolokia-cpu" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::tomcat::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "cpu-load"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        "--warning" = "$jolokia_warn$"
        "--critical" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "jolokia-threads" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::tomcat::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "threads"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        "--warning" = "$jolokia_warn$"
        "--critical" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "jolokia-memory" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::tomcat::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "memory"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        "--warning" = "$jolokia_warn$"
        "--critical" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "jolokia-memory-detailed" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::tomcat::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "memory-detailed"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        "--warning" = "$jolokia_warn$"
        "--critical" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "jolokia-solr-cache-usage" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::java::solr::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "cache-usage"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        "--warning-hits-count" = "$jolokia_warn$"
        "--critical-hits-count" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "jolokia-solr-request-handler" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::java::solr::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "request-handler-usage"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        "--warning-avg-time" = "$jolokia_warn$"
        "--critical-avg-time" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "jolokia-custom" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "apps::protocols::jmx::plugin"
        "--custommode" = "jolokia"
        "--mode" = "numeric-value"
        "--url" = "$jolokia_url$"
        "--username" = "$jolokia_username$"
        "--password" = "$jolokia_password$"
        "--mbean-pattern" = "java.lang:type=Memory"
        "--attribute" = "HeapMemoryUsage"
        "--lookup-path" = "used"
        "--format-scale" = ""
        "--format" = "HeapMemory Usage used: %s"
        "--perfdata-unit" = "B"
        "--perfdata-name" = "used"
        "--warning" = "$jolokia_warn$"
        "--critical" = "$jolokia_crit$"
        "--range-perfdata" = "1"
        }
}

/* Azure Integration */

object CheckCommand "azure-blob-capacity" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::azure::storage::storageaccount::plugin"
        "--custommode" = "api"
        "--mode" = "blob-capacity"
        "--subscription" = "$azure_subscription$"
        "--tenant" = "$azure_tenant$"
        "--client-id" = "$azure_client_id$"
        "--client-secret" = "$azure_client_secret$"
        "--resource" = "$host.vars.azure_resource_name$"
        "--resource-group" = "$host.vars.azure_resource_group$"
        "--timeframe" = "3600"
        "--interval" = "PT60M"
        "--range-perfdata" = "1"
        "--timeout" = "30"
        "--warning-blobcapacity-total" = "$host.vars.blob_limit$"
        }
}

object CheckCommand "azure-transactions-latency" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::azure::storage::storageaccount::plugin"
        "--custommode" = "api"
        "--mode" = "transactions-latency"
        "--subscription" = "$azure_subscription$"
        "--tenant" = "$azure_tenant$"
        "--client-id" = "$azure_client_id$"
        "--client-secret" = "$azure_client_secret$"
        "--resource" = "$host.vars.azure_resource_name$"
        "--resource-group" = "$host.vars.azure_resource_group$"
        "--interval" = "PT60M"
        "--timeframe" = "3600"
        "--range-perfdata" = "1"
        "--zeroed" = ""
        "--timeout" = "30"
        }
}

object CheckCommand "azure-backup-items-status" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::azure::management::recovery::plugin"
        "--custommode" = "api"
        "--mode" = "backup-items-status"
        "--subscription" = "$azure_subscription$"
        "--tenant" = "$azure_tenant$"
        "--client-id" = "$azure_client_id$"
        "--client-secret" = "$azure_client_secret$"
        "--vault-name" = "$host.vars.azure_vault_name$"
        "--resource-group" = "$host.vars.azure_resource_group$"
        "--interval" = "PT60M"
        "--timeframe" = "3600"
        "--critical-status" = "%{last_backup_status} eq 'Failed'"
        "--timeout" = "30"
        }
}

object CheckCommand "azure-vpn-status" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::azure::network::vpngateway::plugin"
        "--custommode" = "api"
        "--mode" = "vpn-gateway-status"
        "--subscription" = "$azure_subscription$"
        "--tenant" = "$azure_tenant$"
        "--client-id" = "$azure_client_id$"
        "--client-secret" = "$azure_client_secret$"
        "--resource-group" = "$host.vars.azure_resource_group$"
        "--timeframe" = "3600"
        "--range-perfdata" = "1"
        "--timeout" = "30"
        }
}

object CheckCommand "azure-site-traffic" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::azure::network::vpngateway::plugin"
        "--custommode" = "api"
        "--mode" = "site-traffic"
        "--subscription" = "$azure_subscription$"
        "--tenant" = "$azure_tenant$"
        "--client-id" = "$azure_client_id$"
        "--client-secret" = "$azure_client_secret$"
        "--resource-group" = "$host.vars.azure_resource_group$"
        "--resource" = "$host.vars.resource$"
        "--timeframe" = "3600"
        "--range-perfdata" = "1"
        "--timeout" = "30"
        }
}

object CheckCommand "azure-tunnel-traffic" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::azure::network::vpngateway::plugin"
        "--custommode" = "api"
        "--mode" = "tunnel-traffic"
        "--subscription" = "$azure_subscription$"
        "--tenant" = "$azure_tenant$"
        "--client-id" = "$azure_client_id$"
        "--client-secret" = "$azure_client_secret$"
        "--resource-group" = "$host.vars.azure_resource_group$"
        "--resource" = "$host.vars.resource$"
        "--timeframe" = "3600"
        "--range-perfdata" = "1"
        "--timeout" = "30"
        }
}

object CheckCommand "azure-database-status" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::azure::database::sqldatabase::plugin"
        "--custommode" = "api"
        "--mode" = "database-status"
        "--subscription" = "$azure_subscription$"
        "--tenant" = "$azure_tenant$"
        "--client-id" = "$azure_client_id$"
        "--client-secret" = "$azure_client_secret$"
        "--resource-group" = "$host.vars.azure_resource_group$"
        "--server" = "$host.vars.azure.dbname$"
        "--range-perfdata" = "1"
        "--timeout" = "30"
        }
}

object CheckCommand "azure-database-size" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::azure::database::sqldatabase::plugin"
        "--custommode" = "api"
        "--mode" = "database-size"
        "--subscription" = "$azure_subscription$"
        "--tenant" = "$azure_tenant$"
        "--client-id" = "$azure_client_id$"
        "--client-secret" = "$azure_client_secret$"
        "--resource-group" = "$host.vars.azure_resource_group$"
        "--server" = "$host.vars.azure.dbname$"
        "--range-perfdata" = "1"
        "--timeout" = "30"
        }
}

/* Azure Kubernetes */

object CheckCommand "aks-node-usage" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::kubernetes::plugin"
        "--custommode" = "kubectl"
        "--mode" = "node-usage"
        "--config-file" = "$host.vars.aks.config$"
        "--debug" = ""
        }
}

object CheckCommand "aks-daemonset-status" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::kubernetes::plugin"
        "--custommode" = "kubectl"
        "--mode" = "daemonset-status"
        "--config-file" = "$host.vars.aks.config$"
        }
}

object CheckCommand "aks-deployment-status" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::kubernetes::plugin"
        "--custommode" = "kubectl"
        "--mode" = "deployment-status"
        "--config-file" = "$host.vars.aks.config$"
        }
}

object CheckCommand "aks-pod-status" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::kubernetes::plugin"
        "--custommode" = "kubectl"
        "--mode" = "pod-status"
        "--config-file" = "$host.vars.aks.config$"
        }
}

/* AWS */

object CheckCommand "aws-bucket-size" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "cloud::aws::s3::plugin"
        "--custommode" = "awscli"
        "--mode" = "bucket-size"
        "--aws-access-key" = "$aws_access_key$"
        "--aws-secret-key" = "$aws_access_key$"
        "--region" = "$host.vars.aws_region$"
        "--name=" = "$host.vars.aws_bucketname$"
        "--warning-bucketsizebytes-standardstorage-average" = "$host.vars.aws_bucket_max$"
        "--range-perfdata" = "1"
        "--zeroed" = ""
        }
}

object CheckCommand "aws-vpn-check" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/nagios-plugin-check-aws-vpn-status/bin/check-aws-vpn-status"]
   arguments = {
        "--aws-access-key-id" = "$aws_access_key_id$"
        "--aws-secret-access-key" = "$aws_secret_access_key$"
        "--region" = "$host.vars.aws_region$"
        "--vpn-connection-id" = "$host.vars.aws_vpnname$"
        }
}

/* MS SQL */

object CheckCommand "mssql-backup-age" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "database::mssql::plugin"
        "--mode" = "backup-age"
        "--hostname" = "$host.vars.dbhost$"
        "--port" = "$host.vars.dbport$"
        "--username" = "$host.vars.dbuser$"
        "--password" = "$host.vars.dbpassword$"
        "--database" = "$host.vars.dbname$"
        "--skip-no-backup" = ""
        }
}

object CheckCommand "mssql-dead-locks" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "database::mssql::plugin"
        "--mode" = "dead-locks"
        "--hostname" = "$host.vars.dbhost$"
        "--port" = "$host.vars.dbport$"
        "--username" = "$host.vars.dbuser$"
        "--database" = "$host.vars.dbname$"
        "--password" = "$host.vars.dbpassword$"
        }
}

object CheckCommand "mssql-databases-size" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "database::mssql::plugin"
        "--mode" = "databases-size"
        "--hostname" = "$host.vars.dbhost$"
        "--port" = "$host.vars.dbport$"
        "--username" = "$host.vars.dbuser$"
        "--database" = "$host.vars.dbname$"
        "--password" = "$host.vars.dbpassword$"
        }
}

object CheckCommand "mssql-blocked-processes" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "database::mssql::plugin"
        "--mode" = "blocked-processes"
        "--hostname" = "$host.vars.dbhost$"
        "--port" = "$host.vars.dbport$"
        "--username" = "$host.vars.dbuser$"
        "--database" = "$host.vars.dbname$"
        "--password" = "$host.vars.dbpassword$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "mssql-locks-waits" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "database::mssql::plugin"
        "--mode" = "locks-waits"
        "--hostname" = "$host.vars.dbhost$"
        "--port" = "$host.vars.dbport$"
        "--username" = "$host.vars.dbuser$"
        "--database" = "$host.vars.dbname$"
        "--password" = "$host.vars.dbpassword$"
        "--range-perfdata" = "1"
        }
}

object CheckCommand "mssql-logs-size" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "database::mssql::plugin"
        "--mode" = "logs-size"
        "--hostname" = "$host.vars.dbhost$"
        "--port" = "$host.vars.dbport$"
        "--username" = "$host.vars.dbuser$"
        "--database" = "$host.vars.dbname$"
        "--password" = "$host.vars.dbpassword$"
        }
}

object CheckCommand "mssql-transactions" {
   import "plugin-check-command"

   command = [ CustomPluginDir + "/centreon-plugins/centreon_plugins.pl"]
   arguments = {
        "--plugin" = "database::mssql::plugin"
        "--mode" = "transactions"
        "--hostname" = "$host.vars.dbhost$"
        "--port" = "$host.vars.dbport$"
        "--username" = "$host.vars.dbuser$"
        "--database" = "$host.vars.dbname$"
        "--password" = "$host.vars.dbpassword$"
        "--range-perfdata" = "1"
        }
}

/* x509 command */

object CheckCommand "icingacli-x509" {
        import "icingacli"

        command += [ "x509", "check", "host" ]

        arguments = {
                "--ip" = {
                        value = "$icingacli_x509_ip$"
                        description = "A hosts IP address"
                }
                "--host" = {
                        value = "$icingacli_x509_host$"
                        description = "A hosts name"
                }
                "--port" = {
                        value = "$icingacli_x509_port$"
                        description = "The port to check in particular"
                }
                "--warning" = {
                        value = "$icingacli_x509_warning$"
                        description = "Less remaining time results in state WARNING"
                }
                "--critical" = {
                        value = "$icingacli_x509_critical$"
                        description = "Less remaining time results in state CRITICAL"
                }
                "--allow-self-signed" = {
                        set_if = "$icingacli_x509_allow_self_signed$"
                        description = "Ignore if a certificate or its issuer has been self-signed"
                }
        }
}